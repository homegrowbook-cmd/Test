(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[859],{63:(e,t,r)=>{"use strict";var a=r(7260);r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},960:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(5125);let s="https://growdiaries-api.railway.app",n=a.A.create({baseURL:s,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let t=localStorage.getItem("accessToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null==(t=e.response)?void 0:t.status)===401&&!r._retry){r._retry=!0;try{let e=localStorage.getItem("refreshToken");if(e){let{accessToken:t}=(await a.A.post("".concat(s,"/auth/refresh"),{refreshToken:e})).data;return localStorage.setItem("accessToken",t),r.headers.Authorization="Bearer ".concat(t),n(r)}}catch(e){localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/auth/login"}}return Promise.reject(e)});let l=n},1511:(e,t,r)=>{Promise.resolve().then(r.bind(r,5064))},3361:(e,t,r)=>{"use strict";r.d(t,{n:()=>l});var a=r(5988),s=r(9863),n=r(960);let l=(0,a.vt)()((0,s.Zr)(e=>({user:null,accessToken:null,refreshToken:null,login:async(t,r)=>{let{user:a,accessToken:s,refreshToken:l}=(await n.A.post("/auth/login",{emailOrUsername:t,password:r})).data;localStorage.setItem("accessToken",s),localStorage.setItem("refreshToken",l),e({user:a,accessToken:s,refreshToken:l})},register:async(e,t,r)=>{await n.A.post("/auth/register",{email:e,username:t,password:r})},logout:()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),e({user:null,accessToken:null,refreshToken:null})},setUser:t=>{e({user:t})}}),{name:"auth-storage",partialize:e=>({user:e.user})}))},5064:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var a=r(5155),s=r(2115),n=r(63),l=r(2619),o=r.n(l),c=r(3361);function i(){let e=(0,n.useRouter)(),{login:t}=(0,c.n)(),[r,l]=(0,s.useState)(""),[i,u]=(0,s.useState)(""),[d,m]=(0,s.useState)(""),[h,p]=(0,s.useState)(!1),g=async a=>{a.preventDefault(),m(""),p(!0);try{await t(r,i),e.push("/runs")}catch(e){var s,n;m((null==(n=e.response)||null==(s=n.data)?void 0:s.message)||"Login failed. Please try again.")}finally{p(!1)}};return(0,a.jsx)("div",{className:"min-h-[calc(100vh-200px)] flex items-center justify-center px-4 py-12",children:(0,a.jsxs)("div",{className:"card max-w-md w-full",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-center mb-8",children:"Login to GrowDiaries"}),d&&(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:d}),(0,a.jsxs)("form",{onSubmit:g,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Email or Username"}),(0,a.jsx)("input",{type:"text",value:r,onChange:e=>l(e.target.value),className:"input",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Password"}),(0,a.jsx)("input",{type:"password",value:i,onChange:e=>u(e.target.value),className:"input",required:!0})]}),(0,a.jsx)("button",{type:"submit",disabled:h,className:"btn-primary w-full",children:h?"Logging in...":"Login"})]}),(0,a.jsxs)("p",{className:"mt-6 text-center text-gray-600 dark:text-gray-400",children:["Don't have an account?"," ",(0,a.jsx)(o(),{href:"/auth/register",className:"text-primary-600 hover:underline",children:"Sign up"})]})]})})}}},e=>{e.O(0,[619,125,214,441,255,358],()=>e(e.s=1511)),_N_E=e.O()}]);